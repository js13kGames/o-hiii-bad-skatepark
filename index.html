<!doctype html>
<head>
<title>O HIII BAD SKATEPARK</title>
<link rel=icon href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text x=%22-.1em%22 y=%22.9em%22 font-size=%2290%22>🛹</text></svg>">
<style>
@font-face{font-family: emoji; src: url(Twemoji.ttf)}
@font-face{font-family:i;src:local(impact),url(//xem.github.io/geoquiz2/i.ttf)}
body { background: #ccc; }
canvas { background: radial-gradient(circle at 400px 0px, #fff 50%,#ddd 80%); display: block; margin: calc(50vh - 300px) auto; cursor: pointer; box-shadow: 5px 5px 50px #888; border-radius: 10px; }
</style>
</head>
<body>
<canvas id=c width=800 height=600></canvas>
<script>

// Helpers
lerp = (start, end, amt) => {
  if(amt > 1) amt = 1;
  return (1-amt)*start+amt*end
}

easeInOutQuad = (x) => {
  if(x > 1) x = 1;
  return x < 0.5 ? 2 * x * x : 1 - Math.pow(-2 * x + 2, 2) / 2;
}

// Globals
state = 0; // 0: title, 1: editor, 2: play
x = c.getContext("2d");
x.fillStyle = "#000";
offsets1 = [20,60,110,140,187,240,290,320,370,410,460,510,555,605,655,705,735];
offset = 10;
title=["T","R","I","S","K","A","I","D","E","K","A","P","H","O","B","I","A"]
offsets2 = [515,682,130,380,425,475,155,315,555,730,270,590,80,20,220,180,635];
amt = 0;
letter = -4;
X = 0,
Y = 200;
amt2 = -450;
mousex = 0;
mousey = 0;

// Game loop
I = setInterval(()=>{
  c.width ^= 0;
  x.save();
  if(state == 0){
    for(i in title){
      x.font = "90px i, impact, calibri, arial";
      x.fillStyle = "#000";
      if(i == letter){
        x.fillText(title[i], X=lerp(offsets1[i],offsets2[i],easeInOutQuad(amt)), Y=lerp(150,250,easeInOutQuad(amt)));
      }
      else if(i < letter){
        x.fillText(title[i], X=offsets2[i], Y=250);
      }
      else if(i > letter){
        x.fillText(title[i], X=offsets1[i], Y=150);
      }
      if(title[i] == "I") {
        x.fillStyle = "#fff";
        x.fillRect(X, Y - 60, 25, 5);
      }
    }
    if(amt >= 1){
      amt = 0;
      letter ++;
      y = 0;
    }
    amt += .1;
    amt2 += 4;
    x.font = "50px i, impact, calibri, arial";
    x.fillText("PLAY",350,530);

    if(amt2 < 1000){
      x.fillRect(0,155,amt2+250,5);
      x.font = "120px emoji";
      x.fillText("✏️",amt2+135,145);
      x.fillText("🕺️",amt2-30,110);
      x.font = "100px emoji";
      x.translate(amt2-40,130);
      x.rotate(.5);
      x.fillText("🛹",0,0);
      
    }
    else {
      x.fillRect(0,155,amt2+70,5);
      x.fillRect(2200-amt2-320,465,1200,5);
      x.translate(2200-amt2-40,440);
      x.scale(-1,1);
      x.font = "150px emoji";
      x.fillText("✏",140,10);
      x.fillText("🕺",10,-20);
      x.rotate(.5);
      x.font = "120px emoji";
      x.fillText("🛹",0,-5);
      amt2+=2;
    }
  
    if(amt2>2100){
      x.restore();
      for(i = 0; i < 90; i++){
        x.globalAlpha = ((100-(2200-amt2))/100/9/((100-i)/15));
        x.drawImage(c, 0, 160+i, 1000, 1, (-90+i)*2, 340-i, 1000+(90-i)*5, 1); 
        x.drawImage(c, 0, 470+i, 1000, 1, (-90+i)*2+40, 590-i, 1000+(70-i)*5, 1); 
      }
    }
    if(amt2>2200){
      amt2 = 2200;
    }
  }
  
  else if(state == 1){
    x.fillRect(mousex, mousey, 20,20);
  }

}, 16)

// Click
c.onclick = () => {
  if(state == 0) state = 1;
  else if(state == 1){
  
  }
}

// Mousemove
c.onmousemove = e => {
  mousex = e.offsetX;
  mousey = e.offsetY;
}
</script>
</body>
